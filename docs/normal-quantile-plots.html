<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Problems and Solutions in Applied Statistics</title>
  <meta name="description" content="A set of problems and solutions, in R, on various parts of applied statistics">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Problems and Solutions in Applied Statistics" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="<a href="http://ritsokiguess.site/pasias" class="uri">http://ritsokiguess.site/pasias</a>" />
  
  <meta property="og:description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
  <meta name="github-repo" content="nxskok/pasias" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Problems and Solutions in Applied Statistics" />
  
  <meta name="twitter:description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
  

<meta name="author" content="Ken Butler">


<meta name="date" content="2018-10-09">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="matched-pairs-t-and-sign-test.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Problems and Solutions in Applied Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html"><i class="fa fa-check"></i><b>2</b> Getting used to R and R Studio</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#getting-an-r-studio-cloud-account"><i class="fa fa-check"></i><b>2.1</b> Getting an R Studio Cloud account</a></li>
<li class="chapter" data-level="2.2" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#getting-started"><i class="fa fa-check"></i><b>2.2</b> Getting started</a></li>
<li class="chapter" data-level="2.3" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#reading-data-from-a-file"><i class="fa fa-check"></i><b>2.3</b> Reading data from a file</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="reading-in-data-and-drawing-some-graphs.html"><a href="reading-in-data-and-drawing-some-graphs.html"><i class="fa fa-check"></i><b>3</b> Reading in data and drawing some graphs</a><ul>
<li class="chapter" data-level="3.1" data-path="reading-in-data-and-drawing-some-graphs.html"><a href="reading-in-data-and-drawing-some-graphs.html#orange-juice"><i class="fa fa-check"></i><b>3.1</b> Orange juice</a></li>
<li class="chapter" data-level="3.2" data-path="reading-in-data-and-drawing-some-graphs.html"><a href="reading-in-data-and-drawing-some-graphs.html#making-soap"><i class="fa fa-check"></i><b>3.2</b> Making soap</a></li>
<li class="chapter" data-level="3.3" data-path="reading-in-data-and-drawing-some-graphs.html"><a href="reading-in-data-and-drawing-some-graphs.html#handling-shipments"><i class="fa fa-check"></i><b>3.3</b> Handling shipments</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-exploration.html"><a href="data-exploration.html"><i class="fa fa-check"></i><b>4</b> Data exploration</a><ul>
<li class="chapter" data-level="4.1" data-path="data-exploration.html"><a href="data-exploration.html#north-carolina-births"><i class="fa fa-check"></i><b>4.1</b> North Carolina births</a></li>
<li class="chapter" data-level="4.2" data-path="data-exploration.html"><a href="data-exploration.html#more-about-the-nc-births"><i class="fa fa-check"></i><b>4.2</b> More about the NC births</a></li>
<li class="chapter" data-level="4.3" data-path="data-exploration.html"><a href="data-exploration.html#nenana-alaska"><i class="fa fa-check"></i><b>4.3</b> Nenana, Alaska</a></li>
<li class="chapter" data-level="4.4" data-path="data-exploration.html"><a href="data-exploration.html#computerized-accounting"><i class="fa fa-check"></i><b>4.4</b> Computerized accounting</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="one-sample-inference.html"><a href="one-sample-inference.html"><i class="fa fa-check"></i><b>5</b> One-sample inference</a><ul>
<li class="chapter" data-level="5.1" data-path="one-sample-inference.html"><a href="one-sample-inference.html#hunter-gatherers-in-australia"><i class="fa fa-check"></i><b>5.1</b> Hunter-gatherers in Australia</a></li>
<li class="chapter" data-level="5.2" data-path="one-sample-inference.html"><a href="one-sample-inference.html#length-of-gestation-in-north-carolina"><i class="fa fa-check"></i><b>5.2</b> Length of gestation in North Carolina</a></li>
<li class="chapter" data-level="5.3" data-path="one-sample-inference.html"><a href="one-sample-inference.html#inferring-ice-break-up-in-nenana"><i class="fa fa-check"></i><b>5.3</b> Inferring ice break-up in Nenana</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="two-sample-inference.html"><a href="two-sample-inference.html"><i class="fa fa-check"></i><b>6</b> Two-sample inference</a><ul>
<li class="chapter" data-level="6.1" data-path="two-sample-inference.html"><a href="two-sample-inference.html#children-and-electronic-devices"><i class="fa fa-check"></i><b>6.1</b> Children and electronic devices</a></li>
<li class="chapter" data-level="6.2" data-path="two-sample-inference.html"><a href="two-sample-inference.html#parking-close-to-the-curb"><i class="fa fa-check"></i><b>6.2</b> Parking close to the curb</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html"><i class="fa fa-check"></i><b>7</b> Power and sample size</a><ul>
<li class="chapter" data-level="7.1" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html#simulating-power"><i class="fa fa-check"></i><b>7.1</b> Simulating power</a></li>
<li class="chapter" data-level="7.2" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html#calculating-power-and-sample-size-for-estimating-mean"><i class="fa fa-check"></i><b>7.2</b> Calculating power and sample size for estimating mean</a></li>
<li class="chapter" data-level="7.3" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html#simulating-power-for-proportions"><i class="fa fa-check"></i><b>7.3</b> Simulating power for proportions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="the-sign-test-and-moods-median-test.html"><a href="the-sign-test-and-moods-median-test.html"><i class="fa fa-check"></i><b>8</b> The sign test and Mood’s median test</a></li>
<li class="chapter" data-level="9" data-path="matched-pairs-t-and-sign-test.html"><a href="matched-pairs-t-and-sign-test.html"><i class="fa fa-check"></i><b>9</b> Matched pairs t and sign test</a></li>
<li class="chapter" data-level="10" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html"><i class="fa fa-check"></i><b>10</b> Normal quantile plots</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Problems and Solutions in Applied Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="normal-quantile-plots" class="section level1">
<h1><span class="header-section-number">Chapter 10</span> Normal quantile plots</h1>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb499-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✔ ggplot2 3.0.0     ✔ purrr   0.2.5
## ✔ tibble  1.4.2     ✔ dplyr   0.7.6
## ✔ tidyr   0.8.1     ✔ stringr 1.3.1
## ✔ readr   1.1.1     ✔ forcats 0.3.0</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<p>The tropical flower <em>Heliconia</em> is
fertilized by hummingbirds, a different species for each variety of
Heliconia. Over time, the lengths of the flowers and the form of the
hummingbirds’ beaks have evolved to match each other. The length of
the Heliconia flower is therefore an important measurement. Does it
have a normal distribution for each variety?</p>
<p>The data set at
<a href="http://www.utsc.utoronto.ca/~butler/c32/heliconia.csv" class="uri">http://www.utsc.utoronto.ca/~butler/c32/heliconia.csv</a> contains
the lengths (in millimetres) of samples of flowers from each of three
varieties of Heliconia: ,  red, and
 yellow.</p>
<ol style="list-style-type: lower-alpha">
<li>Read the data into R. There are different numbers of length
measurements for each variety. How does this show up in the data
frame? (Look at all the rows, not just the first ten.)</li>
</ol>
<p>Solution</p>
<p>The usual <code>read_csv</code>:</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb503-1" data-line-number="1">heliconia=<span class="kw">read_csv</span>(<span class="st">&quot;heliconia.csv&quot;</span>)</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   bihai = col_double(),
##   caribaea_red = col_double(),
##   caribaea_yellow = col_double()
## )</code></pre>
<p>I suggested to look at <em>all</em> the rows. Here’s why:</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb505-1" data-line-number="1">heliconia <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print</span>(<span class="dt">n=</span><span class="ot">Inf</span>) </a></code></pre></div>
<pre><code>## # A tibble: 23 x 3
##    bihai caribaea_red caribaea_yellow
##    &lt;dbl&gt;        &lt;dbl&gt;           &lt;dbl&gt;
##  1  47.1         41.9            36.8
##  2  46.8         42.0            37.0
##  3  46.8         41.9            36.5
##  4  47.1         43.1            36.1
##  5  46.7         41.5            36.0
##  6  47.4         41.7            35.4
##  7  46.4         39.8            38.1
##  8  46.6         40.6            37.1
##  9  48.1         39.6            35.2
## 10  48.3         42.2            36.8
## 11  48.2         40.7            36.7
## 12  50.3         37.9            35.7
## 13  50.1         39.2            36.0
## 14  46.3         37.4            34.6
## 15  46.9         38.2            34.6
## 16  48.4         38.1            NA  
## 17  NA           38.1            NA  
## 18  NA           38.0            NA  
## 19  NA           38.8            NA  
## 20  NA           38.2            NA  
## 21  NA           38.9            NA  
## 22  NA           37.8            NA  
## 23  NA           38.0            NA</code></pre>
<p>The varieties with fewer values have missings (NAs) attached to the
end. This is because all the columns in a data frame have to have the
same number of values. (The missings won’t impact what we do below —
we get a warning but not an error, and the plots are the same as they
would be without the missings — but you might be aesthetically
offended by them, in which case you can read what I do later on.)</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Make a normal quantile plot for the variety
.</li>
</ol>
<p>Solution</p>
<p>There’s a certain amount of repetitiveness here (that we work
around later):</p>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb507-1" data-line-number="1"><span class="kw">ggplot</span>(heliconia,<span class="kw">aes</span>(<span class="dt">sample=</span>bihai))<span class="op">+</span><span class="kw">stat_qq</span>()<span class="op">+</span><span class="kw">stat_qq_line</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 7 rows containing non-finite values (stat_qq).</code></pre>
<pre><code>## Warning: Removed 7 rows containing non-finite values (stat_qq_line).</code></pre>
<p><img src="09-normal-quantile_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>I’m saving the comments until we’ve seen all three.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Make a normal quantile plot for the variety
 red (note that the variable name in the data
frame has an underscore in it).</li>
</ol>
<p>Solution</p>
<p>Same idea again:</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb510-1" data-line-number="1"><span class="kw">ggplot</span>(heliconia,<span class="kw">aes</span>(<span class="dt">sample=</span>caribaea_red))<span class="op">+</span><span class="kw">stat_qq</span>()<span class="op">+</span><span class="kw">stat_qq_line</span>()</a></code></pre></div>
<p><img src="09-normal-quantile_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Make a normal quantile plot for the variety
 yellow (this also has an underscore in it).</li>
</ol>
<p>Solution</p>
<p>And, one more time:</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb511-1" data-line-number="1"><span class="kw">ggplot</span>(heliconia,<span class="kw">aes</span>(<span class="dt">sample=</span>caribaea_yellow))<span class="op">+</span><span class="kw">stat_qq</span>()<span class="op">+</span><span class="kw">stat_qq_line</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 8 rows containing non-finite values (stat_qq).</code></pre>
<pre><code>## Warning: Removed 8 rows containing non-finite values (stat_qq_line).</code></pre>
<p><img src="09-normal-quantile_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>I did a lot of copying and pasting there.</p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Which of the three varieties is closest to having a normal
distribution? Explain (very) briefly.</li>
</ol>
<p>Solution</p>
<p>Look at the three plots, and see which one stays closest to the
line. To my mind, this is clearly the last one, 
yellow. So your answer ought to be `` yellow,
because the points are closest to the line’’. This, I would say,
is acceptably close to normal, so using a <span class="math inline">\(t\)</span>-test here would be fine.
The answer “the last one” is not quite complete, because I
asked you which <em>variety</em>, so your answer needs to name a variety.</p>
<ol start="6" style="list-style-type: lower-alpha">
<li>For each of the two other varieties, apart from the one you
mentioned in the last part, describe briefly how their distributions fail
to be normal.</li>
</ol>
<p>Solution</p>
<p>Let’s look at  first. I see this one as an almost
classic curve: the points are above the line, then below, then
above again. If you look at the data scale (<span class="math inline">\(y\)</span>-axis), the points
are too bunched up to be normal at the bottom, and too spread out
at the top: that is, skewed to the <em>right</em>.
You might also (reasonably) take the view that the points at the
bottom are close to the line (not sure about the very smallest
one, though), but the points at the top are farther away, so that
what we have here is two outliers at the top. I’m OK with that.
It’s often difficult to distinguish between skewness and outliers
(at the end of the long tail). What you conclude can often depend
on how you look.
We also had to look at the second plot, 
red. This is a rather strange one: the points veer away from the
line at the ends, but look carefully: it is <em>not</em> outliers
at both ends, but rather the points are <em>too bunched up</em> to
be normal at both ends: that is, the distribution has  compared to the normal. It is something more like a
uniform distribution, which has no tails at all, than a normal
distribution, which won’t have outliers but it <em>does</em> have
some kind of tails. So, “short tails”.
Extra: that’s all you needed, but I mentioned above that you might have
been offended aesthetically by those missing values that were not
really missing. Let’s see if we can do this aesthetically. As you
might expect, it uses several of the tools from the “tidyverse”.
First, tidy the data. The three columns of the data frame are all
lengths, just lengths of different things, which need to be
labelled. This is <code>gather</code> from <code>tidyr</code>.</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb514-1" data-line-number="1">heliconia.long=heliconia <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb514-2" data-line-number="2"><span class="kw">gather</span>(variety,length,bihai<span class="op">:</span>caribaea_yellow,<span class="dt">na.rm=</span>T)</a>
<a class="sourceLine" id="cb514-3" data-line-number="3">heliconia.long  </a></code></pre></div>
<pre><code>## # A tibble: 54 x 2
##    variety length
##  * &lt;chr&gt;    &lt;dbl&gt;
##  1 bihai     47.1
##  2 bihai     46.8
##  3 bihai     46.8
##  4 bihai     47.1
##  5 bihai     46.7
##  6 bihai     47.4
##  7 bihai     46.4
##  8 bihai     46.6
##  9 bihai     48.1
## 10 bihai     48.3
## # ... with 44 more rows</code></pre>
<p>This is now aesthetic as well as tidy: all those <code>NA</code> lines
have gone (you can check that
there are now <span class="math inline">\(16+23+15=54\)</span> rows of actual data, as there should be).</p>
<p>Now, how to get a normal quantile plot for each variety? This is
<code>facet_wrap</code> on the end of the <code>ggplot</code> again.</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb516-1" data-line-number="1"><span class="kw">ggplot</span>(heliconia.long,<span class="kw">aes</span>(<span class="dt">sample=</span>length))<span class="op">+</span></a>
<a class="sourceLine" id="cb516-2" data-line-number="2"><span class="kw">stat_qq</span>()<span class="op">+</span><span class="kw">stat_qq_line</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb516-3" data-line-number="3"><span class="kw">facet_wrap</span>(<span class="op">~</span>variety,<span class="dt">scale=</span><span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="09-normal-quantile_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>These are a bit elongated vertically. The <code>scale=&quot;free&quot;</code> allows
a different vertical scale for each plot (otherwise there would be one
vertical scale for all three plots); I decided that was best here
since the typical lengths for the three varieties are
different.  yellow is more or less straight,
 has outliers (and may also be curved), 
red has that peculiar S-bend shape.</p>
<p>I didn’t really like the vertical elongation. I’d rather have the
plots be almost square, which they would be if we put them in three
cells of a <span class="math inline">\(2 \times 2\)</span> grid. <code>facet_wrap</code> has <code>nrow</code>
and <code>ncol</code> which you can use one or both of to make this
happen. This creates an array of plots with two columns and as many
rows as needed:</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb517-1" data-line-number="1"><span class="kw">ggplot</span>(heliconia.long,<span class="kw">aes</span>(<span class="dt">sample=</span>length))<span class="op">+</span></a>
<a class="sourceLine" id="cb517-2" data-line-number="2"><span class="kw">stat_qq</span>()<span class="op">+</span><span class="kw">stat_qq_line</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb517-3" data-line-number="3"><span class="kw">facet_wrap</span>(<span class="op">~</span>variety,<span class="dt">scale=</span><span class="st">&quot;free&quot;</span>,<span class="dt">ncol=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="09-normal-quantile_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>I think the square plots make it easier to see the shape of these:
curved, S-bend, straightish.
Almost the same code will get a histogram for each variety, which I’ll
also make squarish:</p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb518-1" data-line-number="1"><span class="kw">ggplot</span>(heliconia.long,<span class="kw">aes</span>(<span class="dt">x=</span>length))<span class="op">+</span></a>
<a class="sourceLine" id="cb518-2" data-line-number="2"><span class="kw">geom_histogram</span>(<span class="dt">binwidth=</span><span class="dv">1</span>)<span class="op">+</span><span class="kw">facet_wrap</span>(<span class="op">~</span>variety,<span class="dt">scale=</span><span class="st">&quot;free&quot;</span>,<span class="dt">ncol=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="09-normal-quantile_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p> has those two outliers,  red has no tails
to speak of (or you might say “it’s bimodal”, which would be another
explanation of the pattern on the normal quantile plot), and
 yellow is shoulder-shruggingly normal (I looked at
that and said, “well, I <em>guess</em> it’s normal”.) After you’ve
looked at the normal quantile plots, you see what a crude tool a
histogram is for assessing normality.</p>
<p>In the lecture notes, we looked at some
data on different athletes from the Australian Institute of
Sport. This data set can be found at
<a href="http://www.utsc.utoronto.ca/~butler/c32/ais.txt" class="uri">http://www.utsc.utoronto.ca/~butler/c32/ais.txt</a>. Recall that the
values are separated by <em>tabs</em>. In this question, we will assess
one of the variables in the data set for normality.</p>
<p>(a)[1] Read the data set into R. (Only one point since you can
copy from the lecture notes.)</p>
<p>Solution</p>
<p><code>read_tsv</code> is the right thing:</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb519-1" data-line-number="1">my_url=<span class="st">&quot;http://www.utsc.utoronto.ca/~butler/c32/ais.txt&quot;</span></a>
<a class="sourceLine" id="cb519-2" data-line-number="2">athletes=<span class="kw">read_tsv</span>(my_url)</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   Sex = col_character(),
##   Sport = col_character(),
##   RCC = col_double(),
##   WCC = col_double(),
##   Hc = col_double(),
##   Hg = col_double(),
##   Ferr = col_integer(),
##   BMI = col_double(),
##   SSF = col_double(),
##   `%Bfat` = col_double(),
##   LBM = col_double(),
##   Ht = col_double(),
##   Wt = col_double()
## )</code></pre>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb521-1" data-line-number="1">athletes</a></code></pre></div>
<pre><code>## # A tibble: 202 x 13
##    Sex   Sport   RCC   WCC    Hc    Hg  Ferr   BMI   SSF `%Bfat`   LBM
##    &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
##  1 fema… Netb…  4.56  13.3  42.2  13.6    20  19.2  49      11.3  53.1
##  2 fema… Netb…  4.15   6    38    12.7    59  21.2 110.     25.3  47.1
##  3 fema… Netb…  4.16   7.6  37.5  12.3    22  21.4  89      19.4  53.4
##  4 fema… Netb…  4.32   6.4  37.7  12.3    30  21.0  98.3    19.6  48.8
##  5 fema… Netb…  4.06   5.8  38.7  12.8    78  21.8 122.     23.1  56.0
##  6 fema… Netb…  4.12   6.1  36.6  11.8    21  21.4  90.4    16.9  56.4
##  7 fema… Netb…  4.17   5    37.4  12.7   109  21.5 107.     21.3  53.1
##  8 fema… Netb…  3.8    6.6  36.5  12.4   102  24.4 157.     26.6  54.4
##  9 fema… Netb…  3.96   5.5  36.3  12.4    71  22.6 101.     17.9  56.0
## 10 fema… Netb…  4.44   9.7  41.4  14.1    64  22.8 126.     25.0  51.6
## # ... with 192 more rows, and 2 more variables: Ht &lt;dbl&gt;, Wt &lt;dbl&gt;</code></pre>
<p>I listed the data to check that I had it right, but I didn’t ask you
to. (If you didn’t have it right, that will show up soon enough.)</p>
<p>(b)[3] One of the variables, <code>Ferr</code>, is a measurement of
Ferritin for each athlete. Obtain a normal quantile plot of the
Ferritin values, for all the athletes together. What do you
conclude about the shape of the distribution? Explain briefly.</p>
<p>Solution</p>
<p>As you would expect:</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb523-1" data-line-number="1"><span class="kw">ggplot</span>(athletes, <span class="kw">aes</span>(<span class="dt">sample=</span>Ferr))<span class="op">+</span></a>
<a class="sourceLine" id="cb523-2" data-line-number="2"><span class="kw">stat_qq</span>()<span class="op">+</span><span class="kw">stat_qq_line</span>()</a></code></pre></div>
<p><img src="09-normal-quantile_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>This is almost a classic right skew: the values are too bunched up at
the bottom and too spread out at the top. The curved shape should be
making you think “skewed” and then you can work out which way it’s
skewed.</p>
<p>(c)[3] It is possible that the shape you found in the previous
part is because the athletes from all the different sports were
mixed together. Use <code>ggplot</code> to obtain one normal quantile
plot for each sport, collected together on one plot.</p>
<p>Solution</p>
<p>Your previous plot had all the sports mixed together. To that
you add something that will put each sport in its own facet:</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb524-1" data-line-number="1"><span class="kw">ggplot</span>(athletes,<span class="kw">aes</span>(<span class="dt">sample=</span>Ferr))<span class="op">+</span><span class="kw">stat_qq</span>()<span class="op">+</span><span class="kw">stat_qq_line</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb524-2" data-line-number="2"><span class="kw">facet_wrap</span>(<span class="op">~</span>Sport)</a></code></pre></div>
<p><img src="09-normal-quantile_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>(d)[2] Looking at the plots in the previous part, would you say
that the Ferritin values for each sport individually have a more
normal shape than they do for all the sports together? Explain
briefly.</p>
<p>Solution</p>
<p>There are a couple of ways you can go, and as ever I’m looking
mostly for consistency of argument. The two major directions you
can go are (i) most of these plots are still curved the same way
as the previous one, and (ii) they are mostly straighter than
they were before.
Possible lines of argument include that pretty much all of these
plots are right-skewed still, with the same upward-opening
curve. Pretty much the only one that doesn’t is Gymnastics, for
which there are only four observations, so you can’t really
tell. So, by this argument, Ferritin just <em>does</em> have a
right-skewed distribution, and breaking things out by sport
doesn’t make much difference to that.
Or, you could go another way and say that the plot of all the
data together was <em>very</em> curved, and these plots are much
less curved, that is to say, much less skewed. Some of them,
such as basketball and netball, are almost straight, and they
are almost normally distributed. Some of the distributions, such
as track sprinting (<code>TSprnt</code>), are definitely still
right-skewed, but not as seriously so as before.
Decide what you think and then discuss how you see it.</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="matched-pairs-t-and-sign-test.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
