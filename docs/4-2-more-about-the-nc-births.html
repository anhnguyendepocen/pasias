<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:title" content="Problems and Solutions in Applied Statistics" />
<meta property="og:type" content="book" />
<meta property="og:url" content="<a href="http://ritsokiguess.site/pasias" class="uri">http://ritsokiguess.site/pasias</a>" />

<meta property="og:description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
<meta name="github-repo" content="nxskok/pasias" />

<meta name="author" content="Ken Butler" />

<meta name="date" content="2018-10-09" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="A set of problems and solutions, in R, on various parts of applied statistics">

<title>Problems and Solutions in Applied Statistics</title>

<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li class="has-sub"><a href="2-getting-used-to-r-and-r-studio.html#getting-used-to-r-and-r-studio"><span class="toc-section-number">2</span> Getting used to R and R Studio</a><ul>
<li><a href="2-1-getting-an-r-studio-cloud-account.html#getting-an-r-studio-cloud-account"><span class="toc-section-number">2.1</span> Getting an R Studio Cloud account</a></li>
<li><a href="2-2-getting-started.html#getting-started"><span class="toc-section-number">2.2</span> Getting started</a></li>
<li><a href="2-3-reading-data-from-a-file.html#reading-data-from-a-file"><span class="toc-section-number">2.3</span> Reading data from a file</a></li>
</ul></li>
<li class="has-sub"><a href="3-reading-in-data-and-drawing-some-graphs.html#reading-in-data-and-drawing-some-graphs"><span class="toc-section-number">3</span> Reading in data and drawing some graphs</a><ul>
<li><a href="3-1-orange-juice.html#orange-juice"><span class="toc-section-number">3.1</span> Orange juice</a></li>
<li><a href="3-2-making-soap.html#making-soap"><span class="toc-section-number">3.2</span> Making soap</a></li>
<li><a href="3-3-handling-shipments.html#handling-shipments"><span class="toc-section-number">3.3</span> Handling shipments</a></li>
</ul></li>
<li class="has-sub"><a href="4-data-exploration.html#data-exploration"><span class="toc-section-number">4</span> Data exploration</a><ul>
<li><a href="4-1-north-carolina-births.html#north-carolina-births"><span class="toc-section-number">4.1</span> North Carolina births</a></li>
<li><a href="4-2-more-about-the-nc-births.html#more-about-the-nc-births"><span class="toc-section-number">4.2</span> More about the NC births</a></li>
<li><a href="4-3-nenana-alaska.html#nenana-alaska"><span class="toc-section-number">4.3</span> Nenana, Alaska</a></li>
<li><a href="4-4-computerized-accounting.html#computerized-accounting"><span class="toc-section-number">4.4</span> Computerized accounting</a></li>
</ul></li>
<li class="has-sub"><a href="5-one-sample-inference.html#one-sample-inference"><span class="toc-section-number">5</span> One-sample inference</a><ul>
<li><a href="5-1-hunter-gatherers-in-australia.html#hunter-gatherers-in-australia"><span class="toc-section-number">5.1</span> Hunter-gatherers in Australia</a></li>
<li><a href="5-2-length-of-gestation-in-north-carolina.html#length-of-gestation-in-north-carolina"><span class="toc-section-number">5.2</span> Length of gestation in North Carolina</a></li>
<li><a href="5-3-inferring-ice-break-up-in-nenana.html#inferring-ice-break-up-in-nenana"><span class="toc-section-number">5.3</span> Inferring ice break-up in Nenana</a></li>
</ul></li>
<li class="has-sub"><a href="6-two-sample-inference.html#two-sample-inference"><span class="toc-section-number">6</span> Two-sample inference</a><ul>
<li><a href="6-1-children-and-electronic-devices.html#children-and-electronic-devices"><span class="toc-section-number">6.1</span> Children and electronic devices</a></li>
<li><a href="6-2-parking-close-to-the-curb.html#parking-close-to-the-curb"><span class="toc-section-number">6.2</span> Parking close to the curb</a></li>
</ul></li>
<li class="has-sub"><a href="7-power-and-sample-size.html#power-and-sample-size"><span class="toc-section-number">7</span> Power and sample size</a><ul>
<li><a href="7-1-simulating-power.html#simulating-power"><span class="toc-section-number">7.1</span> Simulating power</a></li>
<li><a href="7-2-calculating-power-and-sample-size-for-estimating-mean.html#calculating-power-and-sample-size-for-estimating-mean"><span class="toc-section-number">7.2</span> Calculating power and sample size for estimating mean</a></li>
<li><a href="7-3-simulating-power-for-proportions.html#simulating-power-for-proportions"><span class="toc-section-number">7.3</span> Simulating power for proportions</a></li>
</ul></li>
<li><a href="8-the-sign-test-and-moods-median-test.html#the-sign-test-and-moods-median-test"><span class="toc-section-number">8</span> The sign test and Mood’s median test</a></li>
<li><a href="9-matched-pairs-t-and-sign-test.html#matched-pairs-t-and-sign-test"><span class="toc-section-number">9</span> Matched pairs t and sign test</a></li>
<li><a href="10-normal-quantile-plots.html#normal-quantile-plots"><span class="toc-section-number">10</span> Normal quantile plots</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="more-about-the-nc-births" class="section level2">
<h2><span class="header-section-number">4.2</span> More about the NC births</h2>
<p>This is an exploration of
some extra issues around the North Carolina births data set.</p>
<ol style="list-style-type: lower-alpha">
<li>How short does a pregnancy have to be, for the birth to be
classified as “premature”? Deduce this from the data, by drawing a
suitable graph or otherwise.</li>
</ol>
<p>Solution</p>
<p>To figure it out from the data, we can
see how <code>Weeks Gestation</code> depends
on <code>Premie?</code>. Some possibilities are boxplots or a
scatterplot. Either of the first two graphs would get full credit (for
the graphing part: you still have to do the explanation) if this
were being marked:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1"><span class="kw">ggplot</span>(bw,<span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">factor</span>(<span class="st">`</span><span class="dt">Premie?</span><span class="st">`</span>),<span class="dt">y=</span><span class="st">`</span><span class="dt">Weeks Gestation</span><span class="st">`</span>))<span class="op">+</span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="03-data-summaries_files/figure-html/unnamed-chunk-17-1.png" width="672"  /></p>
<p>The warning is because the prematurity of one of the babies is not known.
Or</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1"><span class="kw">ggplot</span>(bw,<span class="kw">aes</span>(<span class="dt">x=</span><span class="st">`</span><span class="dt">Premie?</span><span class="st">`</span>,<span class="dt">y=</span><span class="st">`</span><span class="dt">Weeks Gestation</span><span class="st">`</span>))<span class="op">+</span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="03-data-summaries_files/figure-html/unnamed-chunk-18-1.png" width="672"  /></p>
<p>The same warning again, for the same reason.</p>
<p>Notice how the graphs are similar in syntax, because the
what-to-plot is the same (apart from the <code>factor</code> thing) and we
just make a small change in
how-to-plot-it. In the boxplot, the thing on the <span class="math inline">\(x\)</span>-scale needs to be
categorical, and <code>Premie?</code> is actually a number, so we’d better
make it into a <code>factor</code>, which is R’s version of a categorical
variable.
<code>Premie.</code> is actually a categorical variable (“premature” or
“not premature”)
masquerading as a quantitative one (1 or 0). It is an “indicator variable”, if
you’re familiar with that term.</p>
<p>It looks as if the breakpoint is 37 weeks: a pregnancy at least that
long is considered normal, but a shorter one ends with a premature
birth. Both plots show the same thing: the `<code>Premie?</code>=1` births
all go with short pregnancies, shorter than 37 weeks. This is
completely clear cut.</p>
<p>Another way to attack this is to use <code>summarize</code>, finding the
max and min:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1">bw <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>( <span class="dt">n=</span><span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb83-2" data-line-number="2"><span class="dt">min=</span><span class="kw">min</span>(<span class="st">`</span><span class="dt">Weeks Gestation</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb83-3" data-line-number="3"><span class="dt">max=</span><span class="kw">max</span>(<span class="st">`</span><span class="dt">Weeks Gestation</span><span class="st">`</span>))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##       n   min   max
##   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1   500    NA    NA</code></pre>
<p>only this is for <em>all</em> the babies, premature or not. So we want it by prematurity,
which means a <code>group_by</code> first:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1">bw <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(<span class="st">`</span><span class="dt">Premie?</span><span class="st">`</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb85-2" data-line-number="2"><span class="kw">summarize</span>( <span class="dt">n=</span><span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb85-3" data-line-number="3"><span class="dt">min=</span><span class="kw">min</span>(<span class="st">`</span><span class="dt">Weeks Gestation</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb85-4" data-line-number="4"><span class="dt">max=</span><span class="kw">max</span>(<span class="st">`</span><span class="dt">Weeks Gestation</span><span class="st">`</span>))</a></code></pre></div>
<pre><code>## # A tibble: 3 x 4
##   `Premie?`     n   min   max
##       &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1         0   424    37    45
## 2         1    75    20    36
## 3        NA     1    NA    NA</code></pre>
<p><code>group_by</code> with a number works, even though using the number
in <code>Premie?</code> in a boxplot didn’t. <code>group_by</code> just uses
the distinct values, whether they are numbers, text or factor levels.</p>
<p>Any of these graphs or summaries will help you answer the question, in
the same way. The ultimate issue here is ``something that will get the
job done’’: it doesn’t matter so much what.</p>
<p>In R, <code>NA</code> means “missing”. When you try to compute something
containing a missing value, the answer is usually missing (since you
don’t know what the missing value is). That’s why the first
<code>summarize</code> gave us missing values: there was one missing weeks
of gestation in with all the ones for which we had values, so the max
and min had to be missing as well. In the second <code>summarize</code>,
the one by whether a baby was born prematurely or not, we learn a bit
more about that missing <code>Premie?</code>: evidently its weeks of
gestation was missing as well, since the min and max of that were
missing.</p>
<p>Here’s that baby. I’m doing a bit of fiddling to show all the columns
(as rows, since there’s only one actual row). Don’t worry about the
second line of code below; we will investigate that later.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1">bw <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">is.na</span>(<span class="st">`</span><span class="dt">Premie?</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb87-2" data-line-number="2"><span class="kw">gather</span>(name,value,<span class="kw">everything</span>())</a></code></pre></div>
<pre><code>## # A tibble: 10 x 2
##    name                 value
##    &lt;chr&gt;                &lt;dbl&gt;
##  1 Father Age           33   
##  2 Mother Age           32   
##  3 Weeks Gestation      NA   
##  4 Pre-natal Visits      9   
##  5 Marital Status        1   
##  6 Mother Weight Gained 25   
##  7 Low Birthweight?      0   
##  8 Weight (pounds)       7.19
##  9 Premie?              NA   
## 10 Few Visits?           0</code></pre>
<p>The <em>only</em> thing that was missing was its weeks of gestation, but
that prevented anyone from figuring out whether it was premature or
not.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Explore the relationship between birth weight and
length of pregancy (“gestation”) using a suitable graph. What do you
see?</li>
</ol>
<p>Solution</p>
<p>This needs
to be a scatterplot because these are both quantitative variables:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1"><span class="kw">ggplot</span>(bw,<span class="kw">aes</span>(<span class="dt">x=</span><span class="st">`</span><span class="dt">Weeks Gestation</span><span class="st">`</span>,<span class="dt">y=</span><span class="st">`</span><span class="dt">Weight (pounds)</span><span class="st">`</span>))<span class="op">+</span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="03-data-summaries_files/figure-html/unnamed-chunk-22-1.png" width="672"  /></p>
<p>You see a rather clear upward trend. Those very underweight babies
came from very short pregnancies, but the vast majority of pregnancies
were of more or less normal length (40 weeks is normal) and resulted
in babies of more or less normal birth weight.</p>
<p>I want to illustrate something else: how about <em>colouring</em> the
births that were premature? Piece of cake with <code>ggplot</code>:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1"><span class="kw">ggplot</span>(bw,<span class="kw">aes</span>(<span class="dt">x=</span><span class="st">`</span><span class="dt">Weeks Gestation</span><span class="st">`</span>,<span class="dt">y=</span><span class="st">`</span><span class="dt">Weight (pounds)</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb91-2" data-line-number="2"><span class="dt">colour=</span><span class="st">`</span><span class="dt">Premie?</span><span class="st">`</span>))<span class="op">+</span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="03-data-summaries_files/figure-html/unnamed-chunk-23-1.png" width="672"  /></p>
<p>That was rather silly because <code>ggplot</code> treated prematureness as a <em>continuous</em> variable, and plotted the values on a dark blue-light blue scale. This is the same issue as on the boxplot above, and has the same solution:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1"><span class="kw">ggplot</span>(bw,<span class="kw">aes</span>(<span class="dt">x=</span><span class="st">`</span><span class="dt">Weeks Gestation</span><span class="st">`</span>,<span class="dt">y=</span><span class="st">`</span><span class="dt">Weight (pounds)</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb93-2" data-line-number="2"><span class="dt">colour=</span><span class="kw">factor</span>(<span class="st">`</span><span class="dt">Premie?</span><span class="st">`</span>)))<span class="op">+</span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="03-data-summaries_files/figure-html/unnamed-chunk-24-1.png" width="672"  /></p>
<p>Better.</p>
<p>With the normal-length pregnancies (red), there seems to be no
relationship between length of pregnancy and birth weight, just a
random variation. But with the premature births, a shorter pregnancy
typically goes with a <em>lower</em> birth weight. This would be why the
birth weights for the premature births were more variable.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Do a web search to find the standard (North American)
definition of a premature birth. Does that correspond to what you saw
in the data? Cite the website you used, for example by saying
“according to <code>URL</code>, ldots”, with <code>URL</code> replaced by
the address of the website you found.</li>
</ol>
<p>Solution</p>
<p>The website <a href="http://www.mayoclinic.org/diseases-conditions/premature-birth/basics/definition/con-20020050" class="uri">http://www.mayoclinic.org/diseases-conditions/premature-birth/basics/definition/con-20020050</a>
says that ``a premature birth is one that occurs before the start of
the 37th week of pregnancy’’, which is exactly what we found. (Note
that I am citing the webpage on which I found this, and I even made it
into a link so that you can check it.) The Mayo Clinic is a famous
hospital system with locations in several US states, so I think we can
trust what its website says.</p>
</div>
<p style="text-align: center;">
<a href="4-1-north-carolina-births.html"><button class="btn btn-default">Previous</button></a>
<a href="4-3-nenana-alaska.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
