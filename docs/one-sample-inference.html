<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Problems and Solutions in Applied Statistics</title>
  <meta name="description" content="A set of problems and solutions on various parts of applied statistics">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Problems and Solutions in Applied Statistics" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="<a href="http://www.utsc.utoronto.ca/~butler/pasias" class="uri">http://www.utsc.utoronto.ca/~butler/pasias</a>" />
  
  <meta property="og:description" content="A set of problems and solutions on various parts of applied statistics" />
  <meta name="github-repo" content="nxskok/pasias" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Problems and Solutions in Applied Statistics" />
  
  <meta name="twitter:description" content="A set of problems and solutions on various parts of applied statistics" />
  

<meta name="author" content="Ken Butler">


<meta name="date" content="2018-10-09">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="data-exploration.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Problems and Solutions in Applied Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html"><i class="fa fa-check"></i><b>2</b> Getting used to R and R Studio</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#getting-started-on-r-studio-cloud"><i class="fa fa-check"></i><b>2.1</b> Getting started on R Studio Cloud</a></li>
<li class="chapter" data-level="2.2" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#getting-used-to-r-studio"><i class="fa fa-check"></i><b>2.2</b> Getting used to R Studio</a></li>
<li class="chapter" data-level="2.3" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#data-file-operations"><i class="fa fa-check"></i><b>2.3</b> Data file operations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="reading-in-data-and-drawing-some-graphs.html"><a href="reading-in-data-and-drawing-some-graphs.html"><i class="fa fa-check"></i><b>3</b> Reading in data and drawing some graphs</a><ul>
<li class="chapter" data-level="3.1" data-path="reading-in-data-and-drawing-some-graphs.html"><a href="reading-in-data-and-drawing-some-graphs.html#orange-juice"><i class="fa fa-check"></i><b>3.1</b> Orange juice</a></li>
<li class="chapter" data-level="3.2" data-path="reading-in-data-and-drawing-some-graphs.html"><a href="reading-in-data-and-drawing-some-graphs.html#making-soap"><i class="fa fa-check"></i><b>3.2</b> Making soap</a></li>
<li class="chapter" data-level="3.3" data-path="reading-in-data-and-drawing-some-graphs.html"><a href="reading-in-data-and-drawing-some-graphs.html#handling-shipments"><i class="fa fa-check"></i><b>3.3</b> Handling shipments</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-exploration.html"><a href="data-exploration.html"><i class="fa fa-check"></i><b>4</b> Data exploration</a><ul>
<li class="chapter" data-level="4.1" data-path="data-exploration.html"><a href="data-exploration.html#question-title"><i class="fa fa-check"></i><b>4.1</b> Question title</a></li>
<li class="chapter" data-level="4.2" data-path="data-exploration.html"><a href="data-exploration.html#question-title-1"><i class="fa fa-check"></i><b>4.2</b> Question title</a></li>
<li class="chapter" data-level="4.3" data-path="data-exploration.html"><a href="data-exploration.html#question-title-2"><i class="fa fa-check"></i><b>4.3</b> Question title</a></li>
<li class="chapter" data-level="4.4" data-path="data-exploration.html"><a href="data-exploration.html#question-title-3"><i class="fa fa-check"></i><b>4.4</b> Question title</a></li>
<li class="chapter" data-level="4.5" data-path="data-exploration.html"><a href="data-exploration.html#question-title-4"><i class="fa fa-check"></i><b>4.5</b> Question title</a></li>
<li class="chapter" data-level="4.6" data-path="data-exploration.html"><a href="data-exploration.html#question-title-5"><i class="fa fa-check"></i><b>4.6</b> Question title</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="one-sample-inference.html"><a href="one-sample-inference.html"><i class="fa fa-check"></i><b>5</b> One-sample inference</a><ul>
<li class="chapter" data-level="5.1" data-path="one-sample-inference.html"><a href="one-sample-inference.html#question-title-6"><i class="fa fa-check"></i><b>5.1</b> Question title</a></li>
<li class="chapter" data-level="5.2" data-path="one-sample-inference.html"><a href="one-sample-inference.html#question-title-7"><i class="fa fa-check"></i><b>5.2</b> Question title</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Problems and Solutions in Applied Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="one-sample-inference" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> One-sample inference</h1>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✔ ggplot2 3.0.0     ✔ purrr   0.2.5
## ✔ tibble  1.4.2     ✔ dplyr   0.7.6
## ✔ tidyr   0.8.1     ✔ stringr 1.3.1
## ✔ readr   1.1.1     ✔ forcats 0.3.0</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<div id="question-title-6" class="section level2">
<h2><span class="header-section-number">5.1</span> Question title</h2>
<p>The data in file
<a href="http://www.utsc.utoronto.ca/~butler/c32/ncbirths.csv" class="uri">http://www.utsc.utoronto.ca/~butler/c32/ncbirths.csv</a> are about
500 randomly chosen births of babies in North Carolina. There is a lot
of information: not just the weight at birth of the baby, but whether
the baby was born prematurely, the ages of the parents, whether the
parents are married, how long (in weeks) the pregnancy lasted (this is
called the “gestation”) and so on. We have seen these data before.</p>
<ol style="list-style-type: lower-alpha">
<li>Read in the data from the file into R, bearing in mind what
type of file it is.</li>
</ol>
<p>Solution</p>
<p>This is a <code>.csv</code> file (it came from a spreadsheet), so it
needs reading in accordingly. Work directly from the URL (rather
than downloading the file, unless you are working offline):</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" data-line-number="1">myurl=<span class="st">&quot;http://www.utsc.utoronto.ca/~butler/c32/ncbirths.csv&quot;</span></a>
<a class="sourceLine" id="cb172-2" data-line-number="2">bw=<span class="kw">read_csv</span>(myurl)</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   `Father Age` = col_integer(),
##   `Mother Age` = col_integer(),
##   `Weeks Gestation` = col_integer(),
##   `Pre-natal Visits` = col_integer(),
##   `Marital Status` = col_integer(),
##   `Mother Weight Gained` = col_integer(),
##   `Low Birthweight?` = col_integer(),
##   `Weight (pounds)` = col_double(),
##   `Premie?` = col_integer(),
##   `Few Visits?` = col_integer()
## )</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>Find a 95% confidence interval for the mean birth weight of
all babies born in North Carolina (of which these babies are a
sample). At the end, you should state what the confidence interval is.
Giving some output is necessary, but <em>not</em> enough by itself.</li>
</ol>
<p>If your variable name has a space or other special character (like a
question mark) in it, remember that you have to surround its name with
backticks, as discussed the first time we looked at these data.</p>
<p>Solution</p>
<p>This:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" data-line-number="1"><span class="kw">t.test</span>(bw<span class="op">$</span><span class="st">`</span><span class="dt">Weight (pounds)</span><span class="st">`</span>)  </a></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  bw$`Weight (pounds)`
## t = 104.94, df = 499, p-value &lt; 2.2e-16
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  6.936407 7.201093
## sample estimates:
## mean of x 
##   7.06875</code></pre>
<p>or (the same, but remember to match your brackets):</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb176-1" data-line-number="1"><span class="kw">with</span>(bw,<span class="kw">t.test</span>(<span class="st">`</span><span class="dt">Weight (pounds)</span><span class="st">`</span>))</a></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  Weight (pounds)
## t = 104.94, df = 499, p-value &lt; 2.2e-16
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  6.936407 7.201093
## sample estimates:
## mean of x 
##   7.06875</code></pre>
<p>The confidence interval goes from 6.94 to 7.20 pounds.</p>
<p>There is an annoyance about <code>t.test</code>. Sometimes you can use
<code>data=</code> with it, and sometimes not. When we do a two-sample
<span class="math inline">\(t\)</span>-test later, there is a “model formula” with a squiggle in it,
and there we can use <code>data=</code>, but here not, so you have to use
the dollar sign or the <code>with</code> to say which data frame to get
things from. The distinction seems to be that emph{if you are using a
model formula}, you can use <code>data=</code>, and if not, not.</p>
<p>This is one of those things that is a consequence of R’s history. The
original <code>t.test</code> was without the model formula and thus
without the <code>data=</code>, but the model formula got “retro-fitted”
to it later. Since the model formula comes from things like
regression, where <code>data=</code> is legit, that had to be retro-fitted
as well. Or, at least, that’s my understanding.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Birth weights of babies born in the United States have a mean
of 7.3 pounds. Is there any evidence that babies born in North
Carolina are less heavy on average? State appropriate hypotheses, do your
test, obtain a P-value and state your conclusion, in terms of the
original data.</li>
</ol>
<p>Solution</p>
<p>Null is that the population mean (the mean weight of all babies born
in North Carolina) is <span class="math inline">\(H_0: mu=7.3\)</span> pounds, and the alternative is
that the mean is less: <span class="math inline">\(H_a: mu&lt;7.3\)</span> pounds. This is a one-sided
alternative, which we need to feed into <code>t.test</code>:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb178-1" data-line-number="1"><span class="kw">t.test</span>(bw<span class="op">$</span><span class="st">`</span><span class="dt">Weight (pounds)</span><span class="st">`</span>,<span class="dt">mu=</span><span class="fl">7.3</span>,<span class="dt">alternative=</span><span class="st">&quot;less&quot;</span>)</a></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  bw$`Weight (pounds)`
## t = -3.4331, df = 499, p-value = 0.0003232
## alternative hypothesis: true mean is less than 7.3
## 95 percent confidence interval:
##      -Inf 7.179752
## sample estimates:
## mean of x 
##   7.06875</code></pre>
<p>$ %$</p>
<p>Or with <code>with</code>. If you see what I mean.</p>
<p>The P-value is 0.0003, which is <em>less</em> than any <span class="math inline">\(alpha\)</span> we might
have chosen: we <em>reject</em> the null hypothesis in favour of the
alternative, and thus we conclude that the mean birth weight of babies
in North Carolina
is indeed less than 7.3 pounds.</p>
<p>“Reject the null hypothesis” is <em>not</em> a complete answer. You
need to say something about what rejecting the null hypothesis means
<em>in this case</em>: that is, you must make a statement about birth
weights of babies.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>The theory behind the <span class="math inline">\(t\)</span>-test says that the distribution of
birth weights should be (approximately) normally distributed. Obtain a
histogram of the birth weights. Does it look approximately normal?
Comment briefly. (You’ll have to pick a number of bins for your
histogram first. I don’t mind very much what you pick, as long as it’s
not obviously too many or too few bins.)</li>
</ol>
<p>Solution</p>
<p>We did this before (and discussed the number of bins before), so
I’ll just reproduce my 10-bin histogram (which is what I preferred,
but this is a matter of taste):</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb180-1" data-line-number="1"><span class="kw">ggplot</span>(bw,<span class="kw">aes</span>(<span class="dt">x=</span><span class="st">`</span><span class="dt">Weight (pounds)</span><span class="st">`</span>))<span class="op">+</span><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">10</span>)</a></code></pre></div>
<p><img src="04-one-sample-inference_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>So, we were assessing normality. What about that?</p>
<p>It is mostly normal-looking, but I am suspicious about those
<em>very</em> low birth weights, the ones below about 4 pounds. There
are too many of those, as I see it.</p>
<p>If you think this is approximately normal, you need to make some
comment along the lines of ``the shape is approximately symmetric with
no outliers’’. I think my first answer is better, but this answer is
worth something, since it is a not completely unreasonable
interpretation of the histogram.</p>
<p>A normal quantile plot is better for assessing normality
than a histogram is, but I won’t make you do one until we have seen
the idea in class. Here’s the normal quantile plot for these data:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" data-line-number="1"><span class="kw">ggplot</span>(bw,<span class="kw">aes</span>(<span class="dt">sample=</span><span class="st">`</span><span class="dt">Weight (pounds)</span><span class="st">`</span>))<span class="op">+</span><span class="kw">stat_qq</span>()<span class="op">+</span><span class="kw">stat_qq_line</span>()</a></code></pre></div>
<p><img src="04-one-sample-inference_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>This is rather striking: the lowest birthweights (the ones below 5
pounds or so) are <em>way</em> too low for a normal distribution to
apply. The top end is fine (except perhaps for that one very heavy
baby), but there are too many low birthweights for a normal
distribution to be believable. Note how much clearer this story is
than on the histogram.</p>
<p>Having said that, the <span class="math inline">\(t\)</span>-test, especially with a sample size as big
as this (500), behaves <em>very</em> well when the data are somewhat
non-normal (because it takes advantage of the Central Limit Theorem:
that is, it’s the <em>sampling distribution of the sample mean</em>
whose shape matters). So, even though the data are definitely not
normal, I wouldn’t be too worried about our test.</p>
<p>This perhaps gives some insight as to why Freedman-Diaconis said we
should use so many bins for our histogram. We have a lot of low-end
outliers, so that the IQR is actually <em>small</em> compared to the
overall spread of the data (as measured, say, by the SD or the range)
and so FD thinks we need a lot of bins to describe the shape. Sturges
is based on data being approximately normal, so it will tend to
produce a small number of bins for data that have outliers.</p>
</div>
<div id="question-title-7" class="section level2">
<h2><span class="header-section-number">5.2</span> Question title</h2>
<p>Nenana, Alaska, is about 50 miles west of Fairbanks.
Every spring, there is a contest in Nenana. A wooden tripod is
placed on the frozen river, and people try to guess the exact minute
when the ice melts enough for the tripod to fall through the ice. The
contest started in 1917 as an amusement for railway workers, and has
taken place every year since. Now, hundreds of thousands of people
enter their guesses on the Internet and the prize for the winner can
be as much as $300,000.</p>
<p>Because so much money is at stake, and because the exact same tripod
is placed at the exact same spot on the ice every year, the data are
consistent and accurate. The data are in
<a href="http://www.utsc.utoronto.ca/~butler/c32/nenana.txt" class="uri">http://www.utsc.utoronto.ca/~butler/c32/nenana.txt</a>.</p>
<p>Yes, we saw these data before.</p>
<ol style="list-style-type: lower-alpha">
<li>Read the data into R, as before, or use the data frame that
you read in before. Note that the values are separated by
<em>tabs</em> rather than spaces, so you’ll need an appropriate
<code>read_</code> to read it in.</li>
</ol>
<p>Solution</p>
<p>These are “tab-separated values”, so <code>read_tsv</code> is the
thing, as for the Australian athletes:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb182-1" data-line-number="1">myurl=<span class="st">&quot;http://www.utsc.utoronto.ca/~butler/c32/nenana.txt&quot;</span></a>
<a class="sourceLine" id="cb182-2" data-line-number="2">nenana=<span class="kw">read_tsv</span>(myurl)</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   Year = col_integer(),
##   JulianDate = col_double(),
##   `Date&amp;Time` = col_character()
## )</code></pre>
<p>Use whatever name you like for the data frame. One that is different
from any of the column headers is smart; then it is clear whether you
mean the whole data frame or one of its columns. <code>ice</code> or
<code>melt</code> or anything like that would also be good.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Obtain a 90% confidence interval for the mean
<code>JulianDate</code>. What interval do you get? Looking back at your
histogram, do you have any doubts about the validity of what you
have just done?</li>
</ol>
<p>Solution</p>
<p>This is a matter of using <code>t.test</code> and pulling out the
interval. Since we are looking for a non-standard interval, we
have to remember <code>conf.level</code> as the way to get the
confidence level that we want. I’m going with <code>with</code> this
time, though the dollar-sign thing is equally as good:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb184-1" data-line-number="1"><span class="kw">with</span>(nenana,<span class="kw">t.test</span>(JulianDate,<span class="dt">conf.level=</span><span class="fl">0.90</span>))</a></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  JulianDate
## t = 197.41, df = 86, p-value &lt; 2.2e-16
## alternative hypothesis: true mean is not equal to 0
## 90 percent confidence interval:
##  124.4869 126.6018
## sample estimates:
## mean of x 
##  125.5443</code></pre>
<p>Between 124.5 and 126.6 days into the year. Converting that into
something we can understand (because I want to), there are
<span class="math inline">\(31+28+31+30=120\)</span> days in
January through April (in a non-leap year), so this says that the mean
breakup date is between about May 4 and May 6.</p>
<p>The <span class="math inline">\(t\)</span>-test is based on an assumption of data coming from a normal
distribution. The histogram we made earlier looks pretty much normal,
so there are no doubts about normality and thus no doubts about the
validity of what we have done, on the evidence we have seen so far. (I
have some doubts on different grounds, based on another of the plots
we did earlier, which I’ll explain later, but all I’m expecting you to
do is to look at the histogram and say ``Yep, that’s normal
enough’’. Bear in mind that the sample size is 87, which is large
enough for the Central Limit Theorem to be pretty helpful, so that we don’t need the data to be more than “approximately normal” for the sampling distribution of the sample mean to be very close to <span class="math inline">\(t\)</span> with the right df.)</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>An old-timer in Nenana strokes his grey beard and says
``When I were young, I remember the tripod used to fall into the
water around May 10’’. In a non-leap year, May 10 is Julian day</li>
</ol>
<ol start="130" style="list-style-type: decimal">
<li>Test the null hypothesis that the mean <code>JulianDay</code> is
130, against the alternative that it is less. What do you conclude?
What practical implication does that have
(assuming that the old-timer has a good memory)?</li>
</ol>
<p>Solution</p>
<p>The test is <code>t.test</code> again, but this time we have to
specify a null mean and a direction of alternative:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb186-1" data-line-number="1"><span class="kw">with</span>(nenana,<span class="kw">t.test</span>(JulianDate,<span class="dt">mu=</span><span class="dv">130</span>,<span class="dt">alternative=</span><span class="st">&quot;less&quot;</span>))</a></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  JulianDate
## t = -7.0063, df = 86, p-value = 2.575e-10
## alternative hypothesis: true mean is less than 130
## 95 percent confidence interval:
##      -Inf 126.6018
## sample estimates:
## mean of x 
##  125.5443</code></pre>
<p>For a test, look first at the P-value, which is 0.0000000002575: that
is to say, the P-value is very small, definitely smaller than 0.05 (or
any other <span class="math inline">\(alpha\)</span> you might have chosen). So we <em>reject</em> the
null hypothesis, and conclude that the mean <code>JulianDate</code> is actually
<em>less</em> than 130.</p>
<p>Now, this is the date on which the ice breaks up on average, and we
have concluded that it is <em>earlier</em> than it used to be, since we
are assuming the old-timer’s memory is correct.</p>
<p>This is evidence in
favour of global warming; a small piece of evidence, to be sure, but
the ice is melting earlier than it used to all over the Arctic, so
it’s not just in Nenana that it is happening. You don’t need to get to
the “global warming” part, but I <em>do</em> want you to observe that
the ice is breaking up earlier than it used to.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Plot <code>JulianDate</code> against <code>Year</code> on a
scatterplot. What recent trends, if any, do you see? Comment
briefly. (You did this before, but I have some extra comments on
the graph this time, so feel free to just read this part.)</li>
</ol>
<p>Solution</p>
<p>I liked the <code>ggplot</code> with a smooth trend on it:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb188-1" data-line-number="1"><span class="kw">ggplot</span>(nenana,<span class="kw">aes</span>(<span class="dt">x=</span>Year,<span class="dt">y=</span>JulianDate))<span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span><span class="kw">geom_smooth</span>()</a></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="04-one-sample-inference_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>There was something obvious to see: after about 1960, there is a clear
downward trend: the ice is breaking up earlier on average every
year. Even though there is a lot of variability, the overall trend,
viewed this way, is clear (and consistent with the test we did
earlier). Note that the old-timer’s value of 130 is the kind of
<code>JulianDate</code> we would typically observe around 1920, which
would make the old-timer over 90 years old.</p>
<p>All right, why did I say I had some doubts earlier? Well, because of
this downward trend, the mean is not actually the same all the way
through, so it doesn’t make all that much sense to estimate it, which
is what we were doing earlier by doing a confidence interval or a
hypothesis test. What would actually make more sense is to estimate
the mean <code>JulianDate</code> <em>for a particular year</em>. This could
be done by a regression: predict <code>JulianDate</code> from
<code>Year</code>, and then get a `<code>confidence interval for the mean response'' (as you would have seen in B27 or will see in C67). The trend isn't really linear, but is not that far off. I can modify the previous picture to give you an idea. Putting in</code>method=“lm”<code>fits a line; as we see later,</code>lm` does regressions in R:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" data-line-number="1"><span class="kw">ggplot</span>(nenana,<span class="kw">aes</span>(<span class="dt">x=</span>Year,<span class="dt">y=</span>JulianDate))<span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb190-2" data-line-number="2"><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>)</a></code></pre></div>
<p><img src="04-one-sample-inference_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Compare the confidence interval for the mean <code>JulianDate</code> in
1920: 126 to 131 (the shaded area on the graph), with 2000: 121 to
125. A change of about 5 days over 80 years. And with the recent trend
that we saw above, it’s probably changing faster than that
now. Sobering indeed.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-exploration.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
